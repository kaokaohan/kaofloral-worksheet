<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>å·¥ä½œå–®</title>
  <style>
    :root {
      --primary: #4a6fa5;
      --primary-light: #e7f0ff;
      --border: #e3e3e3;
      --bg: #f5f5f7;
      --text-main: #222;
      --text-sub: #777;
    }
    * { box-sizing: border-box; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Noto Sans TC", "Segoe UI", sans-serif;
      background: var(--bg);
      margin: 0;
      padding: 0;
      color: var(--text-main);
    }
    .page {
      max-width: 960px;
      margin: 0 auto;
      padding: 16px 12px 40px;
    }
    header { margin-bottom: 8px; }
    header h1 {
      font-size: 1.3rem;
      margin: 0 0 4px;
      text-align: center;
    }
    header .hint {
      font-size: 0.85rem;
      color: var(--text-sub);
      text-align: center;
    }

    .backend-links {
      padding: 15px;
      background: #f2f2f2;
      border-bottom: 1px solid #ddd;
    }
    .backend-links h2 { margin-top: 0; }

    /* æ—¥æœŸå°è¦½åˆ— */
    .date-nav-wrapper {
      position: sticky;
      top: 0;
      z-index: 10;
      padding-top: 6px;
      margin: 8px -12px 4px;
      background: linear-gradient(to bottom, rgba(245,245,247,0.96), rgba(245,245,247,0.9), rgba(245,245,247,0));
      backdrop-filter: blur(6px);
    }
    .date-nav {
      display: flex;
      gap: 6px;
      overflow-x: auto;
      padding: 6px 12px 4px;
      -webkit-overflow-scrolling: touch;
    }
    .date-chip {
      flex: 0 0 auto;
      font-size: 0.85rem;
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid var(--border);
      background: white;
      color: var(--text-main);
      cursor: pointer;
      white-space: nowrap;
    }
    .date-chip.primary {
      border-color: var(--primary);
      background: var(--primary-light);
      color: var(--primary);
      font-weight: 600;
    }

    /* æœƒé¤¨ç¯©é¸åˆ— */
    .hall-filters {
      display: flex;
      gap: 6px;
      padding: 4px 12px 10px;
      overflow-x: auto;
    }
    .hall-chip {
      flex: 0 0 auto;
      font-size: 0.82rem;
      padding: 5px 11px;
      border-radius: 999px;
      border: 1px solid var(--border);
      background: #fff;
      color: var(--text-main);
      cursor: pointer;
      white-space: nowrap;
    }
    .hall-chip.active {
      border-color: #2f855a;
      background: #e6f4ec;
      color: #276749;
      font-weight: 600;
    }

    /* å¡ç‰‡ */
    .item {
      background: #ffffff;
      border-radius: 12px;
      padding: 0;
      margin-bottom: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.04);
      border: 1px solid var(--border);
      overflow: hidden;
    }
    .item-header {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 10px 12px;
      cursor: pointer;
    }
    .title {
      font-size: 0.98rem;
      font-weight: 600;
      flex: 1;
    }
    .badge {
      font-size: 0.7rem;
      padding: 3px 7px;
      border-radius: 999px;
      border: 1px solid #ddd;
      color: var(--text-sub);
    }
    .chevron {
      font-size: 0.9rem;
      color: var(--text-sub);
      transition: transform 0.18s ease;
    }
    .item.collapsed .chevron { transform: rotate(-90deg); }
    .item-body {
      padding: 0 12px 10px;
      border-top: 1px solid #f0f0f0;
    }
    .item.collapsed .item-body { display: none; }
    .btn-row {
      display: flex;
      justify-content: flex-end;
      gap: 6px;
      margin: 8px 0 6px;
    }
    .copy-btn {
      font-size: 0.8rem;
      padding: 5px 10px;
      border-radius: 999px;
      border: 1px solid var(--primary);
      background: var(--primary);
      color: white;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 4px;
    }
    .copy-btn.small {
      font-size: 0.75rem;
      padding: 4px 8px;
    }
    .text-box {
      width: 100%;
      min-height: 220px;
      border-radius: 10px;
      border: 1px solid #ddd;
      padding: 8px;
      font-family: inherit;
      font-size: 0.9rem;
      line-height: 1.5;
      resize: vertical;
      background: #fcfcfc;
    }
  </style>
</head>

<body>

<div class="backend-links">
  <h2>è³‡è¨Š</h2>
  <ul style="line-height:1.8;">
    <li><a href="https://kaoflower-staff.netlify.app/staff-price" target="_blank">å“¡å·¥åƒ¹ç¶²é (å¯†ç¢¼20261234)</a></li>
    <li><a href="https://sites.google.com/view/kaofloral-blessing" target="_blank">æ¬¾å¼ç…§ç‰‡ç¶²é </a></li>    
  </ul>
</div>

<div class="page">
  <header>
    <h1>å·¥ä½œå–®</h1>
  </header>

  <div class="date-nav-wrapper">
    <div class="date-nav" id="dateNav"></div>
    <div class="hall-filters">
      <button class="hall-chip active" data-hall="all">å…¨éƒ¨</button>
      <button class="hall-chip" data-hall="æ…ˆé—œ">åªçœ‹æ…ˆé—œ</button>
      <button class="hall-chip" data-hall="æ±å‰">åªçœ‹æ±å‰</button>
      <button class="hall-chip" data-hall="å²‘èŠ¯">åªçœ‹å²‘èŠ¯</button>
      <button class="hall-chip" data-hall="æ­£é”">åªçœ‹æ­£é”</button>
      <button class="hall-chip" data-hall="ç¦æ²…">åªçœ‹ç¦æ²…</button>
    </div>
  </div>

  <div id="caseContainer"></div>
</div>

<script>
fetch("/content/cases.json?v=" + Date.now())
  .then(res => {
    if (!res.ok) throw new Error("HTTP " + res.status);
    return res.json();
  })
  .then(data => {
    window.CASES = data.items || [];
    renderCases();
  })
  .catch(err => {
    console.error("è¼‰å…¥ cases.json å¤±æ•—ï¼š", err);
    alert("è¼‰å…¥è³‡æ–™å¤±æ•—ï¼Œè«‹ç¢ºèª /content/cases.json æ˜¯å¦å­˜åœ¨ã€è·¯å¾‘æ˜¯å¦æ­£ç¢º");
  });
</script>


<script>
  function renderCases() {
    if (!window.CASES || !Array.isArray(window.CASES)) return;

    const container = document.getElementById("caseContainer");
    const dateNav = document.getElementById("dateNav");

    container.innerHTML = "";
    dateNav.innerHTML = "";

    const dateKeys = [...new Set(window.CASES.map(c => c.dateKey))];

    // å»ºæ—¥æœŸ chips
    dateKeys.forEach(k => {
      const btn = document.createElement("button");
      btn.className = "date-chip";
      // k ä¾‹å¦‚ d1121 â†’ é¡¯ç¤º 11/21
      const raw = k.replace(/^d/, "");
      const label = raw.slice(0, 2) + "/" + raw.slice(2);
      btn.textContent = label;
      btn.dataset.target = k;

      btn.onclick = () => {
        const target = document.getElementById(k);
        if (target) {
          const top = target.getBoundingClientRect().top + window.scrollY - 80;
          window.scrollTo({ top, behavior: "smooth" });
        }
        document.querySelectorAll(".date-chip").forEach(c => c.classList.remove("primary"));
        btn.classList.add("primary");
      };

      dateNav.appendChild(btn);
    });

// å»ºå¡ç‰‡
window.CASES.forEach((c, i) => {
  let anchor = document.getElementById(c.dateKey);
  if (!anchor) {
    anchor = document.createElement("div");
    anchor.id = c.dateKey;
    container.appendChild(anchor);
  }

  const item = document.createElement("div");
  item.className = "item";
  item.dataset.hall = c.hall;

  // âœ… å…ˆåœ¨ JS è£¡ç®—å¥½ imgBlockï¼Œå†å¡é€² HTML
  const imgBlock = (c.image && String(c.image).trim())
    ? `<div style="margin-top:10px">
         <img src="${c.image}"
              alt="åƒè€ƒåœ–"
              style="width:100%;max-height:420px;object-fit:contain;border-radius:10px;border:1px solid #eee;background:#fff;" />
       </div>`
    : "";

  item.innerHTML = `
    <div class="item-header">
      <div class="title">${c.title}</div>
      <span class="badge">${c.hall}</span>
      <span class="chevron">âŒ„</span>
    </div>
    <div class="item-body">
      <div class="btn-row">
        <button class="copy-btn small" data-target="txt${i}">ğŸ“‹ ä¸€éµè¤‡è£½</button>
      </div>

      <textarea id="txt${i}" class="text-box" readonly>
${c.firstLine}
ğŸŒ¸ è¦ªæ„›çš„è¦ªå‹æ‚¨å¥½ï¼š

ç‚ºå”åŠ©è™•ç†å‘Šåˆ¥å¼ç¾å ´èŠ±ç±ƒçš„é è¨‚ï¼Œæˆ‘å€‘å·²å‚™å¦¥ç·šä¸Šè¨‚è³¼è¡¨å–®ï¼Œæ‚¨å¯é€éä¸‹æ–¹é€£çµå¡«å¯«ï¼š

ğŸ”— å‘Šåˆ¥å¼æœƒå ´èŠ±ç±ƒè¨‚è³¼é 
${c.url}

è‹¥æ‚¨ä¸ä¾¿å¡«å¯«ï¼Œä¹Ÿå¯ä»¥ç›´æ¥å‚³ LINE å‘ŠçŸ¥æˆ‘å€‘ä»¥ä¸‹è³‡è¨Šï¼Œæˆ‘å€‘å°‡ç‚ºæ‚¨è™•ç†ï¼š
1ï¸âƒ£ è¨‚è³¼æ•¸é‡ï¼ˆå¦‚ï¼š1å°ï¼‰
2ï¸âƒ£ èŠ±å¡è½æ¬¾ç½²å
3ï¸âƒ£ è¯çµ¡äººå§“åèˆ‡é›»è©±
4ï¸âƒ£ æ”¶æ“šå¯„é€åœ°å€
5ï¸âƒ£ åŒ¯æ¬¾è­‰æ˜ï¼ˆæ‹ç…§æˆ–å¾Œ5ç¢¼ï¼‰

ğŸ’°åŒ¯æ¬¾è³‡è¨Šï¼š
æ°¸è±éŠ€è¡Œ807 æ·±å‘åˆ†è¡Œ
æˆ¶åï¼šé«˜äºæ¶µ
å¸³è™Ÿï¼š17801800223376
ï¼ˆè«‹å‚™è¨»è¨‚è³¼äººå§“åï¼‰

â—æé†’ï¼šèŠ±ç±ƒå°‡çµ±ä¸€é€è‡³ã€Œå‘Šåˆ¥å¼æœƒå ´ã€ï¼Œéå®‰éˆè™•ã€‚

å¦‚éœ€å–æ¶ˆï¼Œè«‹æ–¼å‘Šåˆ¥å¼å‰ä¸€æ—¥å‘ŠçŸ¥ï¼Œå°‡æ‰£$15æ‰‹çºŒè²»é€€æ¬¾ã€‚

æ„Ÿè¬æ‚¨çš„è‡´æ„ã€‚</textarea>

      ${imgBlock}
    </div>
  `;

  container.appendChild(item);
});


    // å¡ç‰‡å±•é–‹ / æ”¶åˆ
    document.querySelectorAll(".item-header").forEach(h => {
      h.addEventListener("click", () => {
        h.parentElement.classList.toggle("collapsed");
      });
    });

    // ä¸€éµè¤‡è£½
    document.querySelectorAll(".copy-btn").forEach(btn => {
      btn.addEventListener("click", () => {
        const id = btn.getAttribute("data-target");
        const textarea = document.getElementById(id);
        if (!textarea) return;
        const text = textarea.value;
        const old = btn.textContent;
        if (navigator.clipboard && navigator.clipboard.writeText) {
          navigator.clipboard.writeText(text).then(() => {
            btn.textContent = "âœ… å·²è¤‡è£½";
            setTimeout(() => (btn.textContent = old), 1500);
          }).catch(() => {});
        } else {
          textarea.focus();
          textarea.select();
          document.execCommand("copy");
          btn.textContent = "âœ… å·²è¤‡è£½";
          setTimeout(() => (btn.textContent = old), 1500);
        }
      });
    });

    // æœƒé¤¨ç¯©é¸
    document.querySelectorAll(".hall-chip").forEach(btn => {
      btn.addEventListener("click", () => {
        document.querySelectorAll(".hall-chip").forEach(b => b.classList.remove("active"));
        btn.classList.add("active");

        const hall = btn.getAttribute("data-hall");
        document.querySelectorAll(".item").forEach(card => {
          if (hall === "all") {
            card.style.display = "";
          } else {
            card.style.display = card.dataset.hall === hall ? "" : "none";
          }
        });
      });
    });
  }

</script>

<script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
<script>
  if (window.netlifyIdentity) {
    window.netlifyIdentity.on("init", user => {
      if (!user) {
        window.netlifyIdentity.on("login", () => {
          document.location.href = "/admin/";
        });
      }
    });
  }
</script>
  
</body>
</html>
